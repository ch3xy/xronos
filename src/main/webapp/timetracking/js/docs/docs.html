<div class="view-header">
    <month-switch date="$ctrl.currentDate"></month-switch>

	<div class="header-bar columns">
		<div data-column="weeknumber">&nbsp;</div>
		<div data-column="weekday">{{$ctrl.t('header.weekday.title')}}</div>
		<div data-column="date">{{$ctrl.t('header.date.title')}}</div>
        <div data-column="type">{{$ctrl.t('header.type.title')}}</div>
		<div data-column="workday">
			<div>{{$ctrl.t('header.workday.title')}}</div>
			<div class="lunchbreak">
				<div>{{$ctrl.t('header.lunchbreak.title')}}</div>
			</div>
		</div>
		<div data-column="summary">
			<div>{{$ctrl.t('header.summary.title')}}</div>
			<div class="summary-types">
				<div class="item">{{$ctrl.t('header.summary.worked.title')}}</div>
				<div class="item">{{$ctrl.t('header.summary.needed.title')}}</div>
				<div class="item">{{$ctrl.t('header.summary.difference.title')}}</div>
			</div>
		</div>
		<div data-column="comment">{{$ctrl.t('header.note.title')}}</div>
	</div>
</div>

<div class="view-body">
	<div class="week" ng-repeat="week in $ctrl.data">
		<div class="week-wrapper columns">
			<div class="weeknumber" data-column="weeknumber">
				<div>{{$ctrl.getCalendarWeek(week)}}</div>
			</div>
			<div class="week-days">
				<div class="day" ng-repeat="day in week" ng-class="{ 'is-weekend':$ctrl.isWeekend(day) }">
					<div class="day-label" data-column="weekday">
						{{$ctrl.formatDateString(day.date, 'dddd')}}
					</div>
					<div class="date-label" data-column="date">
						{{$ctrl.formatDateString(day.date, 'DD.MM.YYYY')}}
					</div>
                    <div class="day-type" data-column="type">
                        <select name="type" ng-model="day.type" ng-change="$ctrl.onTypeChange(day)">
                            <option ng-repeat="type in $ctrl.dayTypes" value="{{type}}">
                                {{$ctrl.getDayTypeTitle(type)}}
                            </option>
                        </select>
                    </div>
					<div class="day-data" data-column="workday">
						<datetime class="time" date="day.workStart" format="HH:mm"
                                  on-change="$ctrl.onWorkStartChange($event, day)"
                                  on-blur="$ctrl.onInputBlur(day)"></datetime>
						<datetime class="time" date="day.breakStart" format="HH:mm"
                                  on-change="$ctrl.onBreakStartChange($event, day)"
                                  on-blur="$ctrl.onInputBlur(day)"></datetime>
						<datetime class="time" date="day.breakEnd" format="HH:mm"
                                  on-change="$ctrl.onBreakEndChange($event, day)"
                                  on-blur="$ctrl.onInputBlur(day)"></datetime>
						<datetime class="time" date="day.workEnd" format="HH:mm"
                                  on-change="$ctrl.onWorkEndChange($event, day)"
                                  on-blur="$ctrl.onInputBlur(day)"></datetime>
					</div>
					<div class="day-summary" data-column="summary">
						<div class="summary-items">
							<div class="item">
								{{$ctrl.getCalculatedWorkhours(day) | duration}}
							</div>
							<div class="item">
								{{$ctrl.getNeededWorkhours(day) | duration}}
							</div>
							<div class="item" ng-class="{ 'is-negative':$ctrl.isDurationNegative($ctrl.getDifferenceWorkhours(day)) }">
								{{$ctrl.getDifferenceWorkhours(day) | duration:true}}
							</div>
						</div>
					</div>
					<div class="day-note" data-column="comment">
						<input type="text" ng-model="day.notes" ng-blur="$ctrl.onInputBlur(day)" />
					</div>
				</div>
			</div>
		</div>
		<div class="week-summary">
			<div class="summary-items">
				<div class="item">
					{{$ctrl.getCalculatedWeekWorkhours(week) | duration}}
				</div>
				<div class="item">
					{{$ctrl.getNeededWeekWorkhours(week) | duration}}
				</div>
				<div class="item" ng-class="{ 'is-negative':$ctrl.isDurationNegative($ctrl.getDifferenceWeekWorkhours(week)) }">
					{{$ctrl.getDifferenceWeekWorkhours(week) | duration:true}}
				</div>
			</div>
		</div>
	</div>
</div>
